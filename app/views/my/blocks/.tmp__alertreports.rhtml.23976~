<h2>Alert Reports</h2>

<%
reports = AlertReport.all(:conditions => ["alert_reports.archived <> 1 AND alerts.author_id = ?", User.current.id], :include => [:alert])
col = Proc.new { |c,l| AlertReportsHelper::custom_color(c, l) }
%>
<% if reports.any? %>
<% reports.each do |report| %>
	<% cc = report.alert.category.color %>
    <div><span style="padding:2px;color:<%= col.call(cc,0.30) %>;background-color:<%= col.call(cc,0.85) %>;border:1px solid <%= col.call(cc,0.70) %>"><%=h report.alert.category.name %>:</span> <%= format_date(report.created_on) %>:  <%= report.text %>
    <%= link_to 'Archive', {:controller => :alert_reports, :action => :archive, :id => report.id }, :confirm => 'Are you sure?', :method => :post %></div>
<% end %>
</table>
<% else %>
<p>No reports</p>
<% end %>
<div>
<%= link_to 'View reports', {:controller => :alert_reports, :action => :index } %>
</div>